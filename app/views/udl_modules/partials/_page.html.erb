<div id="module-<%= page.parameterize %>" class="module-page">
  <a id="<%= page.parameterize %>"></a>
  <h2><%= page %></h2>
  
  <% @udl_module.get_sections_by_page(page.parameterize.underscore.to_sym).each do |section| %>
    <a id="<%= section.slug %>"></a>
    <div class="module-section-title-wrapper" data-no-turbolink>
        <h3>
          <% unless section.hide_title %>
            <%= section.title %> 
          <% end %>
          <% if policy(@udl_module).update? %> 
            <span class="edit-module-section-link"> 
              <%= link_to(
                    fa_icon( "pencil", text: "Edit this section"), 
                    edit_udl_module_section_path(udl_module_slug: @udl_module.slug, slug: section.slug),
                    id: "edit-udl-module-section-#{section.slug}"
                  ) %>
            </span>
          <% end %>
        </h3>
      </div>
      <div class="module-section-content-wrapper">
        <%= section.content.html_safe %>
      </div>
  <% end %>
  <% if policy(@udl_module).update? %>
    <p>
      <%= link_to(
            fa_icon("plus", text: "Add a section"), 
            new_udl_module_section_path(udl_module_slug: @udl_module.slug, parent: page.parameterize.underscore),
            id: "udl-module-add-#{page.parameterize}-section",
            class: "create-module-button" 
          ) %>
    </p>
  <% end %>
</div>
